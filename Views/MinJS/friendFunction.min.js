async function checkFriend(){var e=CryptoJS.AES.decrypt(localStorage.getItem("username"),"username").toString(CryptoJS.enc.Utf8);if(e)if(e.startsWith("guest"))document.getElementById("friendTextDisplay").style.display="inline",document.getElementById("friendTextDisplay").innerText="Log in to chat friends",document.getElementById("friendList").style.display="none";else{e=await(await fetch("/friendList",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e})})).json();if("success"===e.message)if(0==e.count){var t=document.getElementById("friendTextDisplay"),n=document.getElementById("friendList");t&&n&&(document.getElementById("friendTextDisplay").style.display="inline",document.getElementById("friendTextDisplay").innerText="You have no friends yet",document.getElementById("friendList").style.display="none")}else{t=(e.list.forEach(e=>{var t,n,i;t=e,(i=document.getElementById("friendContainerHolder"))&&((n=document.createElement("div")).setAttribute("class","h-[15rem] w-full border-2 border-blue-500 rounded-lg flex flex-col space-y-4 overflow-y-auto overflow-x-hidden p-2 xsm:h-[10rem] md:h-[20rem] lg:h-[15rem]"),n.setAttribute("id","parentContainerPrivate-"+t),n.setAttribute("style","scroll-behavior: smooth; display:none"),i.appendChild(n)),t=e,(i=document.getElementById("friendList"))&&!1===i.contains(document.getElementById("div_friend_"+t))&&((n=document.createElement("div")).setAttribute("class","w-full h-fit p-2 flex justify-center items-center rounded-2xl bg-blue-500 cursor-pointer hover:bg-blue-700"),n.setAttribute("id","div_friend_"+t),n.setAttribute("onclick",'openFriendChat("'+t+'")'),i.appendChild(n),(i=document.createElement("p")).setAttribute("class","font-Pixelify text-center text-sm text-white"),i.appendChild(document.createTextNode(t)),n.appendChild(i),(i=document.createElement("span")).setAttribute("class","rounded-full bg-red-500 font-Pixelify text-white text-sm p-1"),i.setAttribute("id","notifMsg_friend_"+t),i.setAttribute("style","display: none;"),n.appendChild(i))}),document.getElementById("friendTextDisplay")),n=document.getElementById("friendList");t&&n&&(document.getElementById("friendTextDisplay").style.display="none",document.getElementById("friendList").style.display="flex")}}else window.location.href="/InvalidUser"}function openFriendChat(e){document.getElementById("friendLobby_status").style.display="inline",document.getElementById("friendName").innerText=e,document.getElementById("activeFriendStatus").style.display="inline",document.getElementById("friendBackBtn").style.display="inline",document.getElementById("frontFriendPanel").style.display="none",document.getElementById("friendChat").style.display="flex";localStorage.setItem("receiver_private",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"receiver").toString()),document.getElementById("parentContainerPrivate-"+e).style.display="flex",socket.emit("friend-status",e),socket.emit("friend-on-lobby",e)}function backToFront(){var e;document.getElementById("friendLobby_status").style.display="none",document.getElementById("friendName").innerText="Friend Chat",document.getElementById("activeFriendStatus").style.display="none",document.getElementById("friendBackBtn").style.display="none",document.getElementById("frontFriendPanel").style.display="flex",document.getElementById("friendChat").style.display="none",localStorage.getItem("receiver_private")&&(e=CryptoJS.AES.decrypt(localStorage.getItem("receiver_private"),"receiver").toString(CryptoJS.enc.Utf8))&&(document.getElementById("parentContainerPrivate-"+e)&&(document.getElementById("parentContainerPrivate-"+e).style.display="none"),private_messageCount=0,document.getElementById("notifMsg_friend_"+e)&&(document.getElementById("notifMsg_friend_"+e).style.display="none"),localStorage.removeItem("receiver_private"))}async function search_player_friendList(){var e,t,n,i,d=document.getElementById("search_friendlist");if(d.value)try{var r,l,s,a=await fetch("/friendList/searchFriendList",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:global_username,searchQuery:d.value})}),o=await a.json();if(document.getElementById("searchLoader").style.display="flex",o){document.getElementById("searchLoader").style.display="none";var c=document.getElementById("friendlist-container");let e=c.lastElementChild;for(;e;)c.removeChild(e),e=c.lastElementChild}"success"===o.message?(e=o.username,t=o.profile,(i=document.getElementById("friendlist-container"))&&((n=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),n.setAttribute("id","list_div_"+e),!1===i.contains(document.getElementById("list_div_"+e))&&i.appendChild(n),(i=document.createElement("div")).setAttribute("class","w-fit h-fit p-4 flex flex-col space-y-2"),n.appendChild(i),(n=document.createElement("div")).setAttribute("class","flex flex-row space-x-2 items-center"),i.appendChild(n),(i=document.createElement("img")).setAttribute("class","w-[3rem] h-[3rem] rounded-full border-2 border-blue-500"),i.setAttribute("alt","user profile"),i.setAttribute("src",t),n.appendChild(i),(t=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black"),t.appendChild(document.createTextNode(e)),n.appendChild(t),(i=document.createElement("button")).setAttribute("class","font-Pixelify text-sm w-fit h-auto p-2 text-white rounded-2xl bg-red-500 hover:bg-red-700"),i.setAttribute("onclick",'removeUser("'+e+'", "list_div_'+e+'")'),i.appendChild(document.createTextNode("Unfriend")),n.appendChild(i))):(r=document.getElementById("friendlist-container"),(l=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),r.appendChild(l),(s=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black"),s.appendChild(document.createTextNode(o.message)),l.appendChild(s))}catch(e){console.log(e)}else{var m=document.getElementById("friendlist-container");let e=m.lastElementChild;for(;e;)m.removeChild(e),e=m.lastElementChild;friendList_view()}}async function search_player_findfriend(){var e,t,n,i,d=document.getElementById("search_findfriend");if(d.value)try{var r,l,s,a=await fetch("/friendList/searchFindFriend",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({searchQuery:d.value})}),o=await a.json();if(document.getElementById("searchLoader").style.display="flex",o){document.getElementById("searchLoader").style.display="none";var c=document.getElementById("friend-container");let e=c.lastElementChild;for(;e;)c.removeChild(e),e=c.lastElementChild}"success"===o.message?(e=o.username,t=o.profile,n=document.getElementById("friend-container"),(i=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),n.appendChild(i),(n=document.createElement("div")).setAttribute("class","w-fit h-fit p-4 flex flex-row space-x-2 items-center cursor-pointer"),n.setAttribute("onclick",'visitUser("'+e+'")'),i.appendChild(n),(i=document.createElement("img")).setAttribute("class","w-[3rem] h-[3rem] rounded-full border-2 border-blue-500"),i.setAttribute("alt","user profile"),i.setAttribute("src",t),n.appendChild(i),(t=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black underline"),t.appendChild(document.createTextNode(e)),n.appendChild(t)):(r=document.getElementById("friend-container"),(l=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),r.appendChild(l),(s=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black"),s.appendChild(document.createTextNode(o.message)),l.appendChild(s))}catch(e){console.log(e)}else{var m=document.getElementById("friend-container");let e=m.lastElementChild;for(;e;)m.removeChild(e),e=m.lastElementChild;findFriend_view()}}async function findFriend_view(){try{var e=CryptoJS.AES.decrypt(localStorage.getItem("username"),"username").toString(CryptoJS.enc.Utf8);if(!1===e)window.location.href="/invalid";else{var t=await(await fetch("/friendList/displayPlayers",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e})})).json();if("success"===t.message){document.getElementById("searchLoader").style.display="none";for(let e=0;e<t.list.length;e++)n=t.list[e].username,i=t.list[e].profile,r=d=r=d=void 0,d=document.getElementById("friend-container"),(r=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),d.appendChild(r),(d=document.createElement("div")).setAttribute("class","w-fit h-fit p-4 flex flex-row space-x-2 items-center cursor-pointer"),d.setAttribute("onclick",'visitUser("'+n+'")'),r.appendChild(d),(r=document.createElement("img")).setAttribute("class","w-[3rem] h-[3rem] rounded-full border-2 border-blue-500"),r.setAttribute("alt","user profile"),r.setAttribute("src",i),d.appendChild(r),(i=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black underline"),i.appendChild(document.createTextNode(n)),d.appendChild(i)}}}catch(e){console.log(e)}var n,i,d,r}async function friendList_view(){try{var e=CryptoJS.AES.decrypt(localStorage.getItem("username"),"username").toString(CryptoJS.enc.Utf8);if(!1===e)window.location.href="/Invalid";else{var t=await(await fetch("/friendList/displayFriend",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e})})).json();if("success"===t.message){document.getElementById("searchLoader").style.display="none";for(let e=0;e<t.requestList.length;e++)l=t.requestList[e].username,s=t.requestList[e].profile,c=o=a=void 0,(c=document.getElementById("requestPanel"))&&((o=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),o.setAttribute("id","req_div_"+l),c.appendChild(o),(c=document.createElement("div")).setAttribute("class","w-fit h-fit p-4 flex flex-col space-y-2"),o.appendChild(c),(o=document.createElement("div")).setAttribute("class","flex flex-row space-x-2 items-center cursor-pointer"),c.appendChild(o),(a=document.createElement("img")).setAttribute("class","w-[3rem] h-[3rem] rounded-full border-2 border-blue-500"),a.setAttribute("alt","user profile"),a.setAttribute("src",s),o.appendChild(a),(s=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black underline"),s.appendChild(document.createTextNode(l)),o.appendChild(s),(a=document.createElement("div")).setAttribute("class","flex flex-row space-x-4"),c.appendChild(a),(o=document.createElement("button")).setAttribute("class","font-Pixelify text-sm w-fit h-auto p-2 text-white rounded-2xl bg-blue-500 hover:bg-blue-700"),o.setAttribute("onclick",'addUser("'+l+'", "req_div_'+l+'")'),o.appendChild(document.createTextNode("Accept")),a.appendChild(o),(s=document.createElement("button")).setAttribute("class","font-Pixelify text-sm w-fit h-auto p-2 text-white rounded-2xl bg-red-500 hover:bg-red-700"),s.setAttribute("onclick",'declineUser("'+l+'", "req_div_'+l+'")'),s.appendChild(document.createTextNode("Decline")),a.appendChild(s));for(let e=0;e<t.friendList.length;e++)n=t.friendList[e].username,i=t.friendList[e].profile,r=d=void 0,(r=document.getElementById("friendlist-container"))&&((d=document.createElement("div")).setAttribute("class","w-full h-fit flex justify-center"),d.setAttribute("id","list_div_"+n),!1===r.contains(document.getElementById("list_div_"+n))&&r.appendChild(d),(r=document.createElement("div")).setAttribute("class","w-fit h-fit p-4 flex flex-col space-y-2"),d.appendChild(r),(d=document.createElement("div")).setAttribute("class","flex flex-row space-x-2 items-center"),r.appendChild(d),(r=document.createElement("img")).setAttribute("class","w-[3rem] h-[3rem] rounded-full border-2 border-blue-500"),r.setAttribute("alt","user profile"),r.setAttribute("src",i),d.appendChild(r),(i=document.createElement("p")).setAttribute("class","font-Pixelify text-md text-black"),i.appendChild(document.createTextNode(n)),d.appendChild(i),(r=document.createElement("button")).setAttribute("class","font-Pixelify text-sm w-fit h-auto p-2 text-white rounded-2xl bg-red-500 hover:bg-red-700"),r.setAttribute("onclick",'removeUser("'+n+'", "list_div_'+n+'")'),r.appendChild(document.createTextNode("Unfriend")),d.appendChild(r))}}}catch(e){console.log(e)}var n,i,d,r,l,s,a,o,c}async function declineUser(e,t){try{var n;"success"===(await(await fetch("/friendList/declineUserRequest",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:global_username,targetPlayer:e})})).json()).message&&(n=document.getElementById(t))&&(socket.emit("request_decline",e),n.parentNode.removeChild(n),friendList_view())}catch(e){console.log(e)}}async function addUser(e,t){notifyAllUsers();try{var n;"success"===(await(await fetch("/friendList/addUserRequest",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:global_username,targetPlayer:e})})).json()).message&&(n=document.getElementById(t))&&(n.parentNode.removeChild(n),friendList_view(),socket.emit("request_accepted",e))}catch(e){console.log(e)}}async function removeUser(e,t){notifyAllUsers();try{var n;"success"===(await(await fetch("/friendList/removeUserToList",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:global_username,targetPlayer:e})})).json()).message&&(n=document.getElementById(t))&&(n.parentNode.removeChild(n),socket.emit("list_removed",e,"list_div_"+global_username,global_username),friendList_view())}catch(e){console.log(e)}}async function visitUser(e){imInLobby(!0,global_username),"success"===(await(await fetch("/player",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e})})).json()).message&&(window.location.href="/player/"+e)}function restartStatus_private(){private_messageCount=0,document.getElementById("notifMsg_friend").style.display="none"}