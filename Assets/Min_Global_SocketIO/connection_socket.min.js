let socket=io();socket.on("connect",async()=>{document.getElementById("loadingSpinner").style.display="flex",document.getElementById("validateText").innerText="Fetching cookies, please wait for a moment...";try{var t;let e=await(await fetch("/cookie/getCookie")).json();e&&(isLoggedIn=!0,localStorage.setItem("username",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e.cookieValue),"username").toString()),addUserList(localStorage.getItem("username")),socket.emit("connected-users",localStorage.getItem("username")),checkFriend(),imInLobby(!1,e.cookieValue),(t=CryptoJS.AES.decrypt(localStorage.getItem("username"),"username").toString(CryptoJS.enc.Utf8))&&socket.emit("clear_lobby",t),(async e=>{try{"success"!==(await(await fetch("/lobby/deleteLobby",{method:"POST",headers:{"Content-Type":"Application/json",Accept:"Application/json"},body:JSON.stringify({username:e})})).json()).message&&alert("failed to clear lobbies")}catch(e){console.log(e)}})(t))}catch(e){console.log(e)}}),socket.on("connected-users",async e=>{var t,n,o,e=CryptoJS.AES.decrypt(e,"username").toString(CryptoJS.enc.Utf8);e?(document.getElementById("loadingSpinner").style.display="none",(t=document.getElementById("parentContainerGlobal"))&&((n=document.createElement("div")).setAttribute("class","flex justify-center items-center w-full h-auto"),t.appendChild(n),(o=document.createElement("p")).setAttribute("class","font-Pixelify text-black text-center text-sm"),o.appendChild(document.createTextNode(e+" connected")),n.appendChild(o),t.scrollTo(0,t.scrollHeight))):window.location.href="/Invalid"}),socket.on("logged-out-users",async e=>{var t=document.getElementById("parentContainerGlobal"),n=document.createElement("div"),o=(n.setAttribute("class","flex justify-center items-center w-full h-auto"),t.appendChild(n),document.createElement("p"));o.setAttribute("class","font-Pixelify text-black text-center text-sm"),o.appendChild(document.createTextNode(e+" left")),n.appendChild(o),t.scrollTo(0,t.scrollHeight)}),socket.on("countUser",e=>{document.getElementById("playerConnected")&&(document.getElementById("playerConnected").innerText="Connected Players: "+e)}),socket.on("invite-custom",(e,t,n)=>{document.getElementById("customButtonDecline").setAttribute("onclick",'declineCustomInvite("'+e+'"); modalStatus("inviteCustomDiv", "inviteCustomContainer", "none", null);'),document.getElementById("customButtonAccept").setAttribute("onclick",'acceptCustomInvite("'+e+'", "'+n+'"); modalStatus("inviteCustomDiv", "inviteCustomContainer", "none", null);'),modalStatus("inviteCustomDiv","inviteCustomContainer","flex","modal_animation"),document.getElementById("customHostName").innerText=e+" inviting you in custom lobby",document.getElementById("hostProfile").src=t;n=document.getElementById("customLoadingBar");n&&(n.style.animation="loadingProgress 5s linear forwards",n.addEventListener("animationend",()=>{declineCustomInvite(e),modalStatus("inviteCustomDiv","inviteCustomContainer","none",null)}))}),socket.on("findMatch_player",e=>{socket.emit("room-status",e,"join");localStorage.setItem("lobby-room",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"lobby-room").toString())}),socket.on("match_start_host",(e,t)=>{socket.emit("match_start_invited",e,t);localStorage.setItem("host",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"host").toString());t=localStorage.getItem("username");document.getElementById("loadingSpinner").style.display="flex",document.getElementById("validateText").innerText="Starting game, please wait...",CryptoJS.AES.decrypt((e="_",t.replace(new RegExp(e,"g"),"/")),"username").toString(CryptoJS.enc.Utf8)?(document.getElementById("loadingSpinner").style.display="none",window.location.href="/Checker/Match-mode/"+(e="_",t.replace(/\//g,e))):window.location.href="/InvalidUser"}),socket.on("match_start_invited",e=>{localStorage.setItem("invited-player",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"invited-player").toString());var t,e=localStorage.getItem("username");document.getElementById("loadingSpinner").style.display="flex",document.getElementById("validateText").innerText="Starting game, please wait...",CryptoJS.AES.decrypt((t="_",e.replace(new RegExp(t,"g"),"/")),"username").toString(CryptoJS.enc.Utf8)?(document.getElementById("loadingSpinner").style.display="none",window.location.href="/Checker/Match-mode/"+(t="_",e.replace(/\//g,t))):window.location.href="/InvalidUser"}),socket.on("match_start_host_guest",(e,t)=>{socket.emit("match_start_invited_guest",e,t);localStorage.setItem("host",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"host").toString());t=localStorage.getItem("username");document.getElementById("loadingSpinner").style.display="flex",document.getElementById("validateText").innerText="Starting game, please wait...",CryptoJS.AES.decrypt((e="_",t.replace(new RegExp(e,"g"),"/")),"username").toString(CryptoJS.enc.Utf8)?(document.getElementById("loadingSpinner").style.display="none",window.location.href="/Checker/Match-mode-guest/"+(e="_",t.replace(/\//g,e))):window.location.href="/InvalidUser"}),socket.on("match_start_invited_guest",e=>{localStorage.setItem("invited-player",CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(e),"invited-player").toString());var t,e=localStorage.getItem("username");document.getElementById("loadingSpinner").style.display="flex",document.getElementById("validateText").innerText="Starting game, please wait...",CryptoJS.AES.decrypt((t="_",e.replace(new RegExp(t,"g"),"/")),"username").toString(CryptoJS.enc.Utf8)?(document.getElementById("loadingSpinner").style.display="none",window.location.href="/Checker/Match-mode-guest/"+(t="_",e.replace(/\//g,t))):window.location.href="/InvalidUser"});